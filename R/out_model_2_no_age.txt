
R version 3.1.2 (2014-10-31) -- "Pumpkin Helmet"
Copyright (C) 2014 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin13.4.0 (64-bit)

R est un logiciel libre livré sans AUCUNE GARANTIE.
Vous pouvez le redistribuer sous certaines conditions.
Tapez 'license()' ou 'licence()' pour plus de détails.

R est un projet collaboratif avec de nombreux contributeurs.
Tapez 'contributors()' pour plus d'information et
'citation()' pour la façon de le citer dans les publications.

Tapez 'demo()' pour des démonstrations, 'help()' pour l'aide
en ligne ou 'help.start()' pour obtenir l'aide au format HTML.
Tapez 'q()' pour quitter R.

[Sauvegarde de la session précédente restaurée]

> # model resimulation for health center were objective function return NAN
> insert_age_structure = FALSE; heterogenous_mixing=FALSE
> source("R/run_first.R")
COSTUM MESSAGE:  deSolve  package was already installed.
COSTUM MESSAGE:  zoo  package was already installed.
COSTUM MESSAGE:  shape  package was already installed.
COSTUM MESSAGE:  lubridate  package was already installed.
COSTUM MESSAGE:  lattice  package was already installed.
COSTUM MESSAGE:  latticeExtra  package was already installed.
COSTUM MESSAGE:  FME  package was already installed.
COSTUM MESSAGE:  hydroGOF  package was already installed.
COSTUM MESSAGE:  ggplot2  package was already installed.
COSTUM MESSAGE:  gplots  package was already installed.
COSTUM MESSAGE:  data.table  package was already installed.
COSTUM MESSAGE:  bbmle  package was already installed.
COSTUM MESSAGE:  XML  package was already installed.
COSTUM MESSAGE:  reshape2  package was already installed.
COSTUM MESSAGE:  plyr  package was already installed.
COSTUM MESSAGE:  nloptr  package was already installed.
COSTUM MESSAGE:  scales  package was already installed.
COSTUM MESSAGE:  ggthemes  package was already installed.
COSTUM MESSAGE:  gridExtra  package was already installed.
COSTUM MESSAGE:  gdata  package was already installed.
Le chargement a nécessité le package : deSolve
Le chargement a nécessité le package : zoo

Attachement du package : ‘zoo’

The following objects are masked from ‘package:base’:

    as.Date, as.Date.numeric

Le chargement a nécessité le package : shape
Le chargement a nécessité le package : lubridate
Le chargement a nécessité le package : lattice
Le chargement a nécessité le package : latticeExtra
Le chargement a nécessité le package : RColorBrewer
Le chargement a nécessité le package : FME
Le chargement a nécessité le package : rootSolve
Le chargement a nécessité le package : coda
Le chargement a nécessité le package : hydroGOF
Le chargement a nécessité le package : ggplot2

Attachement du package : ‘ggplot2’

The following object is masked from ‘package:latticeExtra’:

    layer

Le chargement a nécessité le package : gplots

Attachement du package : ‘gplots’

The following object is masked from ‘package:stats’:

    lowess

Le chargement a nécessité le package : data.table

Attachement du package : ‘data.table’

The following objects are masked from ‘package:lubridate’:

    hour, mday, month, quarter, wday, week, yday, year

Le chargement a nécessité le package : bbmle
Le chargement a nécessité le package : stats4
Le chargement a nécessité le package : XML
Le chargement a nécessité le package : reshape2

Attachement du package : ‘reshape2’

The following objects are masked from ‘package:data.table’:

    dcast, melt

Le chargement a nécessité le package : plyr

Attachement du package : ‘plyr’

The following object is masked from ‘package:lubridate’:

    here

Le chargement a nécessité le package : nloptr
Le chargement a nécessité le package : scales
Le chargement a nécessité le package : ggthemes
Le chargement a nécessité le package : gridExtra
Le chargement a nécessité le package : gdata
gdata: read.xls support for 'XLS' (Excel 97-2004) files ENABLED.

gdata: read.xls support for 'XLSX' (Excel 2007+) files ENABLED.

Attachement du package : ‘gdata’

The following object is masked from ‘package:gridExtra’:

    combine

The following object is masked from ‘package:stats4’:

    nobs

The following object is masked from ‘package:data.table’:

    last

The following object is masked from ‘package:stats’:

    nobs

The following object is masked from ‘package:utils’:

    object.size

Necessary packages are now installed and already loaded into the current envirement or workspace...

 Data base has: 
 -  102729 observations.
 -  9 columns.
 The data.frame contains  12 districts which are:
 BOULSA, DAFRA, DANDE, DÔ, GOURCY, HOUNDÉ, KARANGASSO VIGUE, LENA, ORODARA, OUAHIGOUYA, SEGUENEGA, YAKO
 The  12  districts are located in  3 regions of Burkina Faso which are:
 CENTRE-NORD, HAUTS-BASSINS, NORD
 The number of health centers per district are as follows:
 BOULSA:31, DAFRA:18, DANDE:25, DÔ:27, GOURCY:13, HOUNDÉ:27, KARANGASSO VIGUE:8, LENA:13, ORODARA:45, OUAHIGOUYA:59, SEGUENEGA:18, YAKO:52
 The names of health centers per district are as follows:
 BOULSA: cm/cma boulsa, cm/cma tougouri, csps belga, csps bellogo, csps boala, csps bonam, csps bouroum, csps dabossomnoré, csps dargo, csps kogsablogo, csps konkora yarcé, csps lillougou, csps mokin yarcé, csps nagbingou, csps niega, csps pelga, csps taffogo, csps taparko, csps tilga, csps toyogdin, csps yalgo, csps yaongo, csps zaongo, csps zeguedegin, dispe/mate urbain, csps barga, csps damkarko ii, csps gargo, csps koulwoko, csps namtenga, dispe/mate zaabga

 DAFRA: cm/cma koko, csps bare, csps guimbi, csps kotédougou, csps kouentou, csps leguema, csps panamasso, csps santidougou, csps sarfalao, csps yegueresso, dispe bolmakote, dispe ouezzin-ville, dispe sect 24, dispe tounouma, csps wara, csps sogossagasso, csps moukouma, dispe sect 25

 DANDE: csps bama, csps banwali, csps boboura, csps dandé, csps desso, csps diarradougou, csps faramana, csps fo, csps kiébani, csps kimini, csps kokoroba, csps korédéni, csps koundougou, csps lahirasso, csps mangorotou, csps padéma, csps samandéni, csps sangouléma, csps séguéré, csps siankoro, csps soungalodaga, csps sourkoudougou, csps toukoro, csps vallée du cou, csps zangoma

 DÔ: csps accart ville, csps colma, csps colsama, csps dogona, csps farakan, csps gnanfongon, csps hamdalaye, csps kiri, csps koumi, csps k. sambla, csps lafiabougou, csps logofourso, csps matourkou, csps nasso, csps peni, csps sikasso-cira, csps tapoko, csps tiara, csps toussina, cm/cma secteur 22, csps kouakoualé, csps sakaby, csps bouende, nra dodougou, csps colma 1, csps belle-ville, csps colma 2

 GOURCY: csps kéra-douré, csps kontigué, csps koundouba, csps mako, csps niessega, csps tamounouma, csps tangaye, csps tangloguin-b, csps rikiba, csps minima douré, csps guiri-guiri, dispe taslima, csps kibilo

 HOUNDÉ: csps bassé, csps békuy, csps béréba, csps bohokari, csps bouahoun, csps bouéré, csps bouni, csps dahoun, csps dougoumanto ii, csps fafo, csps founzan, csps gombélédougou, csps karaba, csps kari, csps kiéré, csps koti, csps koumbia, csps maro, csps pê, csps sara, csps sebedougou, csps urbain, csps wakuy, csps indini, csps kouloho, csps kovio, csps nahi

 KARANGASSO VIGUE: csps deguelin, csps k. vigue, csps poya, csps soumousso, csps wara, csps dan, csps yegueresso, dispe diosso

 LENA: csps bah, csps balla, csps dorossiamasso, csps fina, csps kofila, csps kwekwesso, csps lena, csps satiri, csps tiarako, dispe/mate bossora, dispe/mate ouerou, csps sissa, nra kadomba

 ORODARA: csps badara, csps bangasso, csps banzon, csps bleni, csps central, csps diéri, csps fadona, csps famberla, csps fara, csps jigouéra, csps kangala, csps kayan, csps koloko, csps korinion, csps kotoura, csps kourouma,, csps mahon, csps morolaba, csps n'dorola, csps n'gorguerla, csps niamberla, csps ouolonkoto, csps samoghiri, csps samororgouan, csps sérékéni, csps sifarasso, csps sikorla, csps silorla, csps sindo, csps sokoroni, csps soukouraba, csps tigan, csps tin, csps urbain, csps zitonossso, csps banflagoué, csps dionkélé, csps guena, csps kongolikoro, csps sidi, csps kokoro, csps n’gorlani, csps sayaga, nra soungaloboungou, nra témètémèsso

 OUAHIGOUYA: csps amne saaba, csps aorema, csps bango, csps barga, csps bingo, csps bogoya, csps boursouma, csps dénéan, csps dinguiri, csps douma, csps gondologo, csps kaïn, csps kalo, csps kapalin, csps koumbane, csps koumbri, csps mènè, csps mogombouli, csps naba tigré, csps namissigma, csps ninga, csps ninigui, csps nongfaïre, csps rikou, csps roba, csps ronga, csps sabouna, csps sissamba, csps sodin, csps somiaga, csps tangaye, csps tougou, csps tougouzaguè, csps tougue, csps ziga, csps zogoré, csps zoodo, dispe kononga, dispe/mate goutoula, dispe/mate lazaret, dispe/mate namissiguia, dispe rim, mate ouffré, nra bidi, csps dessè, dispe kao, csps pella, dispe bougoure, csps sim, csps bembela, csps birgondogo, csps bissiguin, csps doubaré, dispe dandambara, dispe nango fulcé, nra bani, nra nodin, nra rigui, nra touya

 SEGUENEGA: csps bema, csps berenga, csps gambo, csps goubré, csps goungré, csps irim, csps kalsaka, csps kossouka, csps pourra, csps rambo, csps ramsa, csps rondo, csps zomkalaga, dispe kondé tangaye, csps bouga, dispe kièblèga, csps teonsgo, nra koumda yargo

 YAKO: csps arbole, csps bagare, csps bokin, csps bouboulou, csps boulkoum, csps boulma, csps boure, csps bouria, csps dourou, csps gomponsom, csps guipa, csps kalamtogo, csps kapon, csps kirsi, csps kona, csps lantaga, csps latodin, csps loungo, csps minissia, csps namassa, csps niognogo, csps ouissiga, csps pelegtenga, csps petit samba, csps pilimpikou, csps rakounga, csps roumtenga, csps samba, csps sarma, csps secteur 5, csps seguedin, csps songnaba, csps tampouy, csps tangand tanga, csps tema, csps thébo, csps tibin, csps tindila, csps toessin, csps yake, csps yalgatenga, csps zongbega, csps zougo, csps zougoungo, dispe/mate kaba, dispe secteur 4, csps pathiri, csps secteur 6, csps kourono, csps tanghin, nra koullou, csps moutoulou

[1] "SEGUENEGA"
[1] "csps bema"
[1] "csps berenga"
[1] "csps bouga"
[1] "csps gambo"
[1] "csps goubré"
[1] "csps kossouka"
[1] "csps rondo"
[1] "SEGUENEGA"
[1] "csps bema"
[1] "csps berenga"
[1] "csps bouga"
[1] "csps gambo"
[1] "csps goubré"
[1] "csps kossouka"
[1] "SEGUENEGA"
[1] "csps bema"
[1] "csps berenga"
[1] "csps bouga"
[1] "csps gambo"
[1] "csps goubré"
[1] "csps kossouka"
[1] "SEGUENEGA"
[1] "csps bema"
[1] "csps berenga"
[1] "csps bouga"
[1] "csps gambo"
[1] "csps goubré"
[1] "csps kossouka"
[1] "SEGUENEGA"
[1] "csps bema"
[1] "csps berenga"
[1] "csps bouga"
[1] "csps gambo"
[1] "csps goubré"
[1] "csps kossouka"
[1] "HOUNDÉ"
[1] "csps békuy"
[1] "csps béréba"
[1] "csps bouni"
[1] "csps founzan"
[1] "csps gombélédougou"
[1] "csps karaba"
[1] "csps kari"
[1] "csps kiéré"
[1] "csps koti"
[1] "csps maro"
[1] "csps pê"
[1] "csps sebedougou"
[1] "csps urbain"
[1] "csps wakuy"
[1] "HOUNDÉ"
[1] "csps békuy"
[1] "csps béréba"
[1] "csps bouni"
[1] "csps founzan"
[1] "csps gombélédougou"
[1] "csps karaba"
[1] "csps kari"
[1] "csps kiéré"
[1] "csps koti"
[1] "csps maro"
[1] "csps pê"
[1] "csps sebedougou"
[1] "csps urbain"
[1] "csps wakuy"
[1] "HOUNDÉ"
[1] "csps békuy"
[1] "csps béréba"
[1] "csps bouni"
[1] "csps founzan"
[1] "csps gombélédougou"
[1] "csps indini"
[1] "csps karaba"
[1] "csps kari"
[1] "csps kiéré"
[1] "csps koti"
[1] "csps kouloho"
[1] "csps kovio"
[1] "csps maro"
[1] "csps nahi"
[1] "csps pê"
[1] "csps sebedougou"
[1] "csps urbain"
[1] "csps wakuy"
[1] "HOUNDÉ"
[1] "csps békuy"
[1] "csps béréba"
[1] "csps bouni"
[1] "csps founzan"
[1] "csps gombélédougou"
[1] "csps indini"
[1] "csps karaba"
[1] "csps kari"
[1] "csps kiéré"
[1] "csps koti"
[1] "csps kouloho"
[1] "csps kovio"
[1] "csps maro"
[1] "csps nahi"
[1] "csps pê"
[1] "csps sebedougou"
[1] "csps urbain"
[1] "csps wakuy"
[1] "HOUNDÉ"
[1] "csps békuy"
[1] "csps béréba"
[1] "csps bouni"
[1] "csps founzan"
[1] "csps gombélédougou"
[1] "csps indini"
[1] "csps karaba"
[1] "csps kari"
[1] "csps kiéré"
[1] "csps koti"
[1] "csps kouloho"
[1] "csps kovio"
[1] "csps maro"
[1] "csps nahi"
[1] "csps pê"
[1] "csps sebedougou"
[1] "csps urbain"
[1] "csps wakuy"
[1] "HOUNDÉ"
[1] "csps békuy"
[1] "csps béréba"
[1] "csps bouni"
[1] "csps founzan"
[1] "csps gombélédougou"
[1] "csps indini"
[1] "csps karaba"
[1] "csps kari"
[1] "csps kiéré"
[1] "csps koti"
[1] "csps kouloho"
[1] "csps kovio"
[1] "csps maro"
[1] "csps nahi"
[1] "csps pê"
[1] "csps sebedougou"
[1] "csps urbain"
[1] "csps wakuy"
[1] "LENA"
[1] "csps balla"
[1] "csps kwekwesso"
[1] "csps sissa"
[1] "csps tiarako"
[1] "LENA"
[1] "csps balla"
[1] "csps kwekwesso"
[1] "csps sissa"
[1] "csps tiarako"
[1] "dispe/mate bossora"
[1] "KARANGASSO VIGUE"
[1] "csps deguelin"
[1] "csps wara"
[1] "KARANGASSO VIGUE"
[1] "csps dan"
[1] "csps deguelin"
[1] "csps wara"
[1] "csps yegueresso"
[1] "dispe diosso"

 Finished loading functions, parameters, and data 

 Finished ploting the health centers data 
 
================================================ 

 Model estimation can be run now for each of the 3 models 
Il y a eu 11 avis (utilisez warnings() pour les visionner)
> source("R/models_parameters.R")
> #dev.off() # clear all graphical devices and plots in the plotting area.
> graphSettings() # seeting plotting parameters
> 
> # MODEL WITH NO AGE STRUCTURE
> # Model 1 # purposfully resimulate some hc with model 1 to check if code modification has an impact on previous prediction
> start.time <- Sys.time()
> nb_iteration = 30000
> # is_a0Constant = FALSE
> # mle_non_epi_seguenNonEpiForc_a0_2007 = mleYearSpecFit(district_id=1,
> #                                                       district_year_data = non_missing_data(seguen_2007), 
> #                                                       population_size = seguen_2007_population_size,
> #                                                       year_now = 2007, hc_vector= c(1,3,6),
> #                                                       a0ForcingOnly=TRUE, beta0ForcingOnly = FALSE, 
> #                                                       addCarriageConstrain = FALSE, show_plot = TRUE, verbose = FALSE,
> #                                                       # choose the appropriate method for algorithm
> #                                                       # use NLOPT_LN_BOBYQA or NLOPT_LN_COBYLA for LSQ fit with nloptr
> #                                                       # use L-BFGS-B for the bbmle package with mle2
> #                                                       algorithm = "NLOPT_LN_COBYLA",  useMLE=F, useLSQ = F,
> #                                                       n_iter = nb_iteration)
> 
> 
> # mle_non_epi_seguenNonEpiForc_a0_2010 = mleYearSpecFit(district_id=1,
> #                                                       district_year_data = non_missing_data(seguen_2010), 
> #                                                       population_size = seguen_2010_population_size,
> #                                                       year_now = 2010, hc_vector= c(2,5),
> #                                                       a0ForcingOnly=TRUE, beta0ForcingOnly = FALSE, 
> #                                                       addCarriageConstrain = FALSE, show_plot = TRUE, verbose = FALSE,
> #                                                       # choose the appropriate method for algorithm
> #                                                       # use NLOPT_LN_BOBYQA or NLOPT_LN_COBYLA for LSQ fit with nloptr
> #                                                       # use L-BFGS-B for the bbmle package with mle2
> #                                                       algorithm = "NLOPT_LN_COBYLA",  useMLE=F, useLSQ = F,
> #                                                       n_iter = nb_iteration)
> # 
> # 
> # mle_non_epi_houndeForc_a0_2006 = mleYearSpecFit(district_id=2,
> #                                                 district_year_data = non_missing_data(hounde_2006), 
> #                                                 population_size = hounde_2006_population_size,
> #                                                 year_now = 2006, hc_vector= c(10),
> #                                                 a0ForcingOnly=TRUE, beta0ForcingOnly = FALSE, 
> #                                                 addCarriageConstrain = FALSE, show_plot = TRUE, verbose = FALSE,
> #                                                 # choose the appropriate method for algorithm
> #                                                 # use NLOPT_LN_BOBYQA or NLOPT_LN_COBYLA for LSQ fit with nloptr
> #                                                 # use L-BFGS-B for the bbmle package with mle2
> #                                                 algorithm = "NLOPT_LN_COBYLA",  useMLE=F, useLSQ = F,
> #                                                 n_iter = nb_iteration)
> # 
> # 
> # mle_non_epi_houndeForc_a0_2008 = mleYearSpecFit(district_id=2,
> #                                                 district_year_data = non_missing_data(hounde_2008), 
> #                                                 population_size = hounde_2008_population_size,
> #                                                 year_now = 2008, hc_vector= c(2),
> #                                                 a0ForcingOnly=TRUE, beta0ForcingOnly = FALSE, 
> #                                                 addCarriageConstrain = FALSE, show_plot = TRUE, verbose = FALSE,
> #                                                 # choose the appropriate method for algorithm
> #                                                 # use NLOPT_LN_BOBYQA or NLOPT_LN_COBYLA for LSQ fit with nloptr
> #                                                 # use L-BFGS-B for the bbmle package with mle2
> #                                                 algorithm = "NLOPT_LN_COBYLA",  useMLE=F, useLSQ = F,
> #                                                 n_iter = nb_iteration)
> # 
> # 
> # mle_non_epi_kvigueForc_a0_2010 = mleYearSpecFit(district_id=4,
> #                                                 district_year_data = non_missing_data(Kvigue_2010), 
> #                                                 population_size = kvigue_2010_population_size,
> #                                                 year_now = 2010, hc_vector= c(3),
> #                                                 a0ForcingOnly=TRUE, beta0ForcingOnly = FALSE, 
> #                                                 addCarriageConstrain = FALSE, show_plot = TRUE, verbose = FALSE,
> #                                                 # choose the appropriate method for algorithm
> #                                                 # use NLOPT_LN_BOBYQA or NLOPT_LN_COBYLA for LSQ fit with nloptr
> #                                                 # use L-BFGS-B for the bbmle package with mle2
> #                                                 algorithm = "NLOPT_LN_COBYLA",  useMLE=F, useLSQ = F,
> #                                                 n_iter = nb_iteration)
> 
> #####################################################################################
> #####################################################################################
> # MODEL 2
> is_a0Constant = TRUE
> mle_non_epi_seguenNonEpiForc_beta0_2007 = mleYearSpecFit(district_id=1,
+                                                          district_year_data = non_missing_data(seguen_2007), 
+                                                          population_size = seguen_2007_population_size,
+                                                          year_now = 2007, hc_vector= c(1,3,6),
+                                                          a0ForcingOnly=FALSE, beta0ForcingOnly = TRUE, 
+                                                          addCarriageConstrain = FALSE, show_plot = TRUE, verbose = FALSE,
+                                                          # choose the appropriate method for algorithm
+                                                          # use NLOPT_LN_BOBYQA or NLOPT_LN_COBYLA for LSQ fit with nloptr
+                                                          # use L-BFGS-B for the bbmle package with mle2
+                                                          algorithm = "NLOPT_LN_COBYLA",  useMLE=F, useLSQ = F,
+                                                          n_iter = nb_iteration)
              population_size
csps bema           12720.469
csps berenga        10070.219
csps bouga           7622.215
csps gambo          15531.784
csps goubré          4641.599
csps kossouka       10660.485

 Will fit the model to the following health centers: 
  SEGUENEGA|csps bema SEGUENEGA|csps bouga SEGUENEGA|csps kossouka
 =====================
 
 Fitting model to  SEGUENEGA|csps bema data. Please wait...

 population size for  SEGUENEGA|csps bema :  12720 

 Carriage Prev week_6_8 / Carriage Prev week_44_46:  9.220463e-10 

 
 Model fitted using the nloptr package for parameters optimisations 
:nloptr(x0 = guess_parms, eval_f = objfunc, lb = lbound, ub = ubound, 
    eval_g_ineq = ineqConstrain, opts = list(algorithm = algorithm, 
        print_level = 0, xtol_rel = 1e-12, maxeval = n_iter), 
    parmset = names(guess_parms), nbYearSimulated = nbYearSimulated, 
    obs.data = obs.data, time.vector = time.vector, verbose = verbose)

 Completed 665 iterations out of  30000  

 Message : NLOPT_XTOL_REACHED: Optimization stopped because xtol_rel or xtol_abs (above) was reached.  Fit status is  ( 4 )

 ====================== 
 
 Details of the fit: 

 Loglikelihood :  -4.216005 

 AICc =  27.78085 and BIC =  40.04196
 =====================
 
 Fitting model to  SEGUENEGA|csps bouga data. Please wait...

 population size for  SEGUENEGA|csps bouga :  7622 

 Carriage Prev week_6_8 / Carriage Prev week_44_46:  1.798783e-10 

 
 Model fitted using the nloptr package for parameters optimisations 
:nloptr(x0 = guess_parms, eval_f = objfunc, lb = lbound, ub = ubound, 
    eval_g_ineq = ineqConstrain, opts = list(algorithm = algorithm, 
        print_level = 0, xtol_rel = 1e-12, maxeval = n_iter), 
    parmset = names(guess_parms), nbYearSimulated = nbYearSimulated, 
    obs.data = obs.data, time.vector = time.vector, verbose = verbose)

 Completed 1476 iterations out of  30000  

 Message : NLOPT_XTOL_REACHED: Optimization stopped because xtol_rel or xtol_abs (above) was reached.  Fit status is  ( 4 )

 ====================== 
 
 Details of the fit: 

 Loglikelihood :  -9.876797 

 AICc =  39.10243 and BIC =  51.36354
 =====================
 
 Fitting model to  SEGUENEGA|csps kossouka data. Please wait...

 population size for  SEGUENEGA|csps kossouka :  10660 

 Carriage Prev week_6_8 / Carriage Prev week_44_46:  1.793458e-10 

 
 Model fitted using the nloptr package for parameters optimisations 
:nloptr(x0 = guess_parms, eval_f = objfunc, lb = lbound, ub = ubound, 
    eval_g_ineq = ineqConstrain, opts = list(algorithm = algorithm, 
        print_level = 0, xtol_rel = 1e-12, maxeval = n_iter), 
    parmset = names(guess_parms), nbYearSimulated = nbYearSimulated, 
    obs.data = obs.data, time.vector = time.vector, verbose = verbose)

 Completed 16082 iterations out of  30000  

 Message : NLOPT_XTOL_REACHED: Optimization stopped because xtol_rel or xtol_abs (above) was reached.  Fit status is  ( 4 )

 ====================== 
 
 Details of the fit: 

 Loglikelihood :  -7.404209 

 AICc =  34.15725 and BIC =  46.41837> 
> 
> mle_non_epi_seguenNonEpiForc_beta0_2010 = mleYearSpecFit(district_id=1,
+                                                          district_year_data = non_missing_data(seguen_2010), 
+                                                          population_size = seguen_2010_population_size,
+                                                          year_now = 2010, hc_vector= c(2,5),
+                                                          a0ForcingOnly=FALSE, beta0ForcingOnly = TRUE, 
+                                                          addCarriageConstrain = FALSE, show_plot = TRUE, verbose = FALSE,
+                                                          # choose the appropriate method for algorithm
+                                                          # use NLOPT_LN_BOBYQA or NLOPT_LN_COBYLA for LSQ fit with nloptr
+                                                          # use L-BFGS-B for the bbmle package with mle2
+                                                          algorithm = "NLOPT_LN_COBYLA",  useMLE=F, useLSQ = F,
+                                                          n_iter = nb_iteration)
              population_size
csps bema               13900
csps berenga            11004
csps bouga               8329
csps gambo              16972
csps goubré              5072
csps kossouka           11649

 Will fit the model to the following health centers: 
  SEGUENEGA|csps berenga SEGUENEGA|csps goubré
 =====================
 
 Fitting model to  SEGUENEGA|csps berenga data. Please wait...

 population size for  SEGUENEGA|csps berenga :  11004 

 Carriage Prev week_6_8 / Carriage Prev week_44_46:  9.363049e-09 

 
 Model fitted using the nloptr package for parameters optimisations 
:nloptr(x0 = guess_parms, eval_f = objfunc, lb = lbound, ub = ubound, 
    eval_g_ineq = ineqConstrain, opts = list(algorithm = algorithm, 
        print_level = 0, xtol_rel = 1e-12, maxeval = n_iter), 
    parmset = names(guess_parms), nbYearSimulated = nbYearSimulated, 
    obs.data = obs.data, time.vector = time.vector, verbose = verbose)

 Completed 14266 iterations out of  30000  

 Message : NLOPT_XTOL_REACHED: Optimization stopped because xtol_rel or xtol_abs (above) was reached.  Fit status is  ( 4 )

 ====================== 
 
 Details of the fit: 

 Loglikelihood :  -14.25115 

 AICc =  47.85114 and BIC =  60.11225
 =====================
 
 Fitting model to  SEGUENEGA|csps goubré data. Please wait...

 population size for  SEGUENEGA|csps goubré :  5072 

 Carriage Prev week_6_8 / Carriage Prev week_44_46:  3.197462e-10 

 
 Model fitted using the nloptr package for parameters optimisations 
:nloptr(x0 = guess_parms, eval_f = objfunc, lb = lbound, ub = ubound, 
    eval_g_ineq = ineqConstrain, opts = list(algorithm = algorithm, 
        print_level = 0, xtol_rel = 1e-12, maxeval = n_iter), 
    parmset = names(guess_parms), nbYearSimulated = nbYearSimulated, 
    obs.data = obs.data, time.vector = time.vector, verbose = verbose)

 Completed 3045 iterations out of  30000  

 Message : NLOPT_XTOL_REACHED: Optimization stopped because xtol_rel or xtol_abs (above) was reached.  Fit status is  ( 4 )

 ====================== 
 
 Details of the fit: 

 Loglikelihood :  -11.86289 

 AICc =  43.07461 and BIC =  55.33572> 
> 
> mle_non_epi_houndeForc_beta0_2006 = mleYearSpecFit(district_id=2,
+                                                    district_year_data = non_missing_data(hounde_2006), 
+                                                    population_size = hounde_2006_population_size,
+                                                    year_now = 2006, hc_vector= c(10),
+                                                    a0ForcingOnly=FALSE, beta0ForcingOnly = TRUE, 
+                                                    addCarriageConstrain = FALSE, show_plot = TRUE, verbose = FALSE,
+                                                    # choose the appropriate method for algorithm
+                                                    # use NLOPT_LN_BOBYQA or NLOPT_LN_COBYLA for LSQ fit with nloptr
+                                                    # use L-BFGS-B for the bbmle package with mle2
+                                                    algorithm = "NLOPT_LN_COBYLA",  useMLE=F, useLSQ = F,
+                                                    n_iter = nb_iteration)
                   population_size
csps békuy                8442.404
csps béréba              11296.224
csps bouni               16419.241
csps founzan             12946.145
csps gombélédougou        3440.222
csps karaba               5694.314
csps kari                11615.191
csps kiéré                6257.614
csps koti                10793.341
csps maro                 4311.828
csps pê                  12725.800
csps sebedougou           4007.965
csps urbain              36408.422
csps wakuy                8811.126

 Will fit the model to the following health centers: 
  HOUNDÉ|csps maro
 =====================
 
 Fitting model to  HOUNDÉ|csps maro data. Please wait...

 population size for  HOUNDÉ|csps maro :  4312 

 Carriage Prev week_6_8 / Carriage Prev week_44_46:  1.235992e-11 

 
 Model fitted using the nloptr package for parameters optimisations 
:nloptr(x0 = guess_parms, eval_f = objfunc, lb = lbound, ub = ubound, 
    eval_g_ineq = ineqConstrain, opts = list(algorithm = algorithm, 
        print_level = 0, xtol_rel = 1e-12, maxeval = n_iter), 
    parmset = names(guess_parms), nbYearSimulated = nbYearSimulated, 
    obs.data = obs.data, time.vector = time.vector, verbose = verbose)

 Completed 8465 iterations out of  30000  

 Message : NLOPT_XTOL_REACHED: Optimization stopped because xtol_rel or xtol_abs (above) was reached.  Fit status is  ( 4 )

 ====================== 
 
 Details of the fit: 

 Loglikelihood :  -6.734611 

 AICc =  32.74195 and BIC =  45.23156> 
> 
> mle_non_epi_houndeForc_beta0_2008 = mleYearSpecFit(district_id=2,
+                                                    district_year_data = non_missing_data(hounde_2008), 
+                                                    population_size = hounde_2008_population_size,
+                                                    year_now = 2008, hc_vector= c(2),
+                                                    a0ForcingOnly=FALSE, beta0ForcingOnly = TRUE, 
+                                                    addCarriageConstrain = FALSE, show_plot = TRUE, verbose = FALSE,
+                                                    # choose the appropriate method for algorithm
+                                                    # use NLOPT_LN_BOBYQA or NLOPT_LN_COBYLA for LSQ fit with nloptr
+                                                    # use L-BFGS-B for the bbmle package with mle2
+                                                    algorithm = "NLOPT_LN_COBYLA",  useMLE=F, useLSQ = F,
+                                                    n_iter = nb_iteration)
                   population_size
csps békuy                8956.546
csps béréba              11984.164
csps bouni               17419.172
csps founzan             13734.565
csps gombélédougou        3649.731
csps indini               9341.126
csps karaba               6041.097
csps kari                12322.556
csps kiéré                6638.703
csps koti                11450.655
csps kouloho              7721.746
csps kovio                4211.519
csps maro                 4574.418
csps nahi                 5900.650
csps pê                  13500.801
csps sebedougou           4252.050
csps urbain              38625.695
csps wakuy                9347.724

 Will fit the model to the following health centers: 
  HOUNDÉ|csps béréba
 =====================
 
 Fitting model to  HOUNDÉ|csps béréba data. Please wait...

 population size for  HOUNDÉ|csps béréba :  11984 

 Carriage Prev week_6_8 / Carriage Prev week_44_46:  4.404034e-12 

 
 Model fitted using the nloptr package for parameters optimisations 
:nloptr(x0 = guess_parms, eval_f = objfunc, lb = lbound, ub = ubound, 
    eval_g_ineq = ineqConstrain, opts = list(algorithm = algorithm, 
        print_level = 0, xtol_rel = 1e-12, maxeval = n_iter), 
    parmset = names(guess_parms), nbYearSimulated = nbYearSimulated, 
    obs.data = obs.data, time.vector = time.vector, verbose = verbose)

 Completed 4820 iterations out of  30000  

 Message : NLOPT_XTOL_REACHED: Optimization stopped because xtol_rel or xtol_abs (above) was reached.  Fit status is  ( 4 )

 ====================== 
 
 Details of the fit: 

 Loglikelihood :  -4.289843 

 AICc =  27.92852 and BIC =  40.18964> 
> 
> mle_non_epi_kvigueForc_beta0_2010 = mleYearSpecFit(district_id=4,
+                                                    district_year_data = non_missing_data(Kvigue_2010), 
+                                                    population_size = kvigue_2010_population_size,
+                                                    year_now = 2010, hc_vector= c(3),
+                                                    a0ForcingOnly=FALSE, beta0ForcingOnly = TRUE, 
+                                                    addCarriageConstrain = FALSE, show_plot = TRUE, verbose = FALSE,
+                                                    # choose the appropriate method for algorithm
+                                                    # use NLOPT_LN_BOBYQA or NLOPT_LN_COBYLA for LSQ fit with nloptr
+                                                    # use L-BFGS-B for the bbmle package with mle2
+                                                    algorithm = "NLOPT_LN_COBYLA",  useMLE=F, useLSQ = F,
+                                                    n_iter = nb_iteration)
                population_size
csps dan                  16317
csps deguelin              7328
csps wara                  8387
csps yegueresso            9253
dispe diosso               5508

 Will fit the model to the following health centers: 
  KARANGASSO VIGUE|csps wara
 =====================
 
 Fitting model to  KARANGASSO VIGUE|csps wara data. Please wait...

 population size for  KARANGASSO VIGUE|csps wara :  8387 

 Carriage Prev week_6_8 / Carriage Prev week_44_46:  9.702469e-12 

 
 Model fitted using the nloptr package for parameters optimisations 
:nloptr(x0 = guess_parms, eval_f = objfunc, lb = lbound, ub = ubound, 
    eval_g_ineq = ineqConstrain, opts = list(algorithm = algorithm, 
        print_level = 0, xtol_rel = 1e-12, maxeval = n_iter), 
    parmset = names(guess_parms), nbYearSimulated = nbYearSimulated, 
    obs.data = obs.data, time.vector = time.vector, verbose = verbose)

 Completed 3039 iterations out of  30000  

 Message : NLOPT_XTOL_REACHED: Optimization stopped because xtol_rel or xtol_abs (above) was reached.  Fit status is  ( 4 )

 ====================== 
 
 Details of the fit: 

 Loglikelihood :  -4.044922 

 AICc =  27.43868 and BIC =  39.69979> 
> #####################################################################################
> #####################################################################################
> 
> save(
+      mle_non_epi_kvigueForc_beta0_2010,
+      mle_non_epi_houndeForc_beta0_2008,
+      mle_non_epi_houndeForc_beta0_2006,
+      mle_non_epi_seguenNonEpiForc_beta0_2010,
+      mle_non_epi_seguenNonEpiForc_beta0_2007,
+      file = "R/some_hc_mle_estimates_no_age_str_model_2.RData")
> 
> 
> end.time <- Sys.time()
> time.taken <- end.time - start.time
> time.taken
Time difference of 1.815791 hours
> 
> # END SIMULATION OF MODEL WITHOUT AGE STRUCTURE
> # 
> 
> 
> 
> proc.time()
utilisateur     système      écoulé 
   6256.038      53.200    6555.906 
